{"version":3,"sources":["../../src/pages/load-document/load-document.module.ts","../../src/pages/load-document/load-document.ts"],"names":[],"mappings":"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","file":"14.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { LoadDocumentPage } from './load-document';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    LoadDocumentPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(LoadDocumentPage),\r\n  ],\r\n})\r\nexport class LoadDocumentPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/load-document/load-document.module.ts","import { Component, ViewChild                                 } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ViewController, ActionSheetController  } from 'ionic-angular';\r\nimport { Camera                                               } from '@ionic-native/camera';\r\nimport { FormBuilder, FormGroup                               } from '@angular/forms';\r\nimport { FileTransfer, FileTransferObject                     } from '@ionic-native/file-transfer';\r\nimport { User, Api                                                 } from '../../providers';\r\n\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-load-document',\r\n  templateUrl: 'load-document.html',\r\n})\r\n \r\nexport class LoadDocumentPage {\r\n\r\n  @ViewChild('fileInput') fileInput;\r\n\r\n  private view          : {color: String, text : String, spinner : boolean, icon : boolean   } = {color : 'b4' ,text : 'Seleccionar imagen', spinner : false, icon : false };\r\n  private isReadyToSave : boolean;\r\n  private form          : FormGroup;\r\n\r\n  constructor(private api : Api, private actionSheetCtrl: ActionSheetController, private user : User, private transfer: FileTransfer, public camera: Camera, public viewCtrl: ViewController, public formBuilder: FormBuilder, public params: NavParams, public navCtrl: NavController, public navParams: NavParams) {\r\n    ////console.log(\"load-documents\");\r\n    this.form = formBuilder.group({\r\n      profilePic: ['']\r\n    });\r\n\r\n    this.form.valueChanges.subscribe((v) => {\r\n      this.isReadyToSave = this.form.valid;\r\n    });\r\n \r\n  }\r\n\r\n  getPicture() {\r\n\r\n    let actionSheet = this.actionSheetCtrl.create({\r\n      title: 'Selecciona la fuente',\r\n      buttons: [{\r\n          text: 'Galería',\r\n\r\n          handler: () => {       \r\n            this.fileInput.nativeElement.click();\r\n          }\r\n        },{\r\n          text: 'Cámara',\r\n          handler: () => {\r\n            this.camera.getPicture({ destinationType: this.camera.DestinationType.DATA_URL, targetWidth: 600, targetHeight: 800, correctOrientation: true}).then((data) => {\r\n              this.form.patchValue({ 'profilePic': 'data:image/jpg;base64,' + data });\r\n              this.view.color = 'green';\r\n              this.view.text = 'Cargar foto';\r\n            }, (err) => {\r\n              alert('No se pudo seleccionar la imagen');\r\n            });\r\n          }\r\n        },\r\n        {\r\n          text: 'Cancelar',\r\n          role: 'cancel'\r\n        }\r\n      ]\r\n    });\r\n\r\n    actionSheet.present();\r\n\r\n\r\n\r\n  }\r\n\r\n  processWebImage(event) {\r\n\r\n    let reader = new FileReader();\r\n    reader.onload = (readerEvent) => {\r\n \r\n      let imageData = (readerEvent.target as any).result;\r\n  \r\n\r\n      this.form.patchValue({ 'profilePic': imageData });\r\n      this.view.color = 'green';\r\n      this.view.text = 'Cargar foto';\r\n\r\n    };\r\n\r\n    reader.readAsDataURL(event.target.files[0]);\r\n\r\n  }\r\n\r\n\r\n  getProfileImageStyle() {\r\n    return 'url(' + this.form.controls['profilePic'].value + ')';\r\n  }\r\n\r\n\r\n\r\n  process(){\r\n\r\n    if (this.isReadyToSave) {\r\n      this.uploadImage();\r\n    }else {\r\n      this.getPicture();\r\n    }\r\n    \r\n  }\r\n\r\n  uploadImage(){  \r\n\r\n    var options = {\r\n      fileKey: \"image\",\r\n      fileName: 'image',\r\n      chunkedMode: false,\r\n      mimeType: \"multipart/form-data\",\r\n      params: {\r\n        'm': 'uDocuments',\r\n        'user' :  this.user.userInfo.userid,\r\n        'document': this.params.data.type,\r\n      }\r\n    };\r\n\r\n    var url = 'https://www.immomexico.com/api/app/api.php';\r\n    var targetPath = this.form.controls['profilePic'].value;\r\n\r\n    var  fileTransfer: FileTransferObject = this.transfer.create();\r\n    this.view.spinner = true;\r\n    this.view.text = '';\r\n\r\n    fileTransfer.upload(targetPath, url, options).then(data => {\r\n\r\n      if(data.responseCode == 200){\r\n\r\n        var response = JSON.parse(data.response);\r\n\r\n        if (response.status == 200) {\r\n\r\n          this.viewCtrl.dismiss([true, this.params.data.type]);\r\n\r\n        } else {\r\n\r\n          this.api.alert(901);          \r\n        }\r\n\r\n      }else{\r\n\r\n        this.api.alert(900);\r\n      }\r\n\r\n      this.view.text    = 'Seleccionar imagen';\r\n      this.view.spinner = false;\r\n\r\n    }, err => {\r\n        this.api.alert(903);\r\n    });\r\n\r\n  }\r\n  \r\n  exit() {\r\n\r\n    this.viewCtrl.dismiss([false, this.params.data.type]);\r\n\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/load-document/load-document.ts"],"sourceRoot":""}