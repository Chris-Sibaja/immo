{"version":3,"sources":["../../src/pages/add-task/add-task.module.ts","../../src/pages/add-task/add-task.ts"],"names":[],"mappings":"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","file":"33.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { AddTaskPage } from './add-task';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AddTaskPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(AddTaskPage),\r\n  ],\r\n})\r\nexport class AddTaskPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-task/add-task.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, AlertController, Platform, ViewController } from 'ionic-angular';\r\nimport { Calendar, CalendarOptions } from '@ionic-native/calendar';\r\nimport { Storage } from '@ionic/storage';\r\nimport { User }from '../../providers';\r\nimport { FormBuilder, FormGroup, Validators } from '../../../node_modules/@angular/forms';\r\n\r\n\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-add-task',\r\n  templateUrl: 'add-task.html',\r\n})\r\nexport class AddTaskPage {\r\n\r\n  public event = { user: 0, folio: 0, subject: \"\", startDate: \"\", startTime: \"\", endDate: \"\", endTime: \"\", reDate: \"\", reTime: \"\", descripcion: \"\" };\r\n\r\n  contactUser: FormGroup;\r\n  public client = false;\r\n  public nameClient = '';\r\n  public date: any;\r\n  public time: any;\r\n  public myDate: any;\r\n  public monthName: any;\r\n  public shortMonthName: any;\r\n  public subjet: any = [];\r\n  public calendars: any;\r\n  public calendarId = 2;\r\n  public phoneCalendar = false;\r\n\r\n  public leadForm: FormGroup;\r\n\r\n  constructor(public formBuilder: FormBuilder, public navCtrl: NavController,    public navParams: NavParams,    private storage: Storage,    public alertCtrl: AlertController,    private calendar: Calendar,    public platform: Platform,private user: User,public viewCtrl: ViewController) {\r\n\r\n    \r\n    this.event.user = this.user.userInfo.userid;\r\n\r\n    this.myDate = new Date().toISOString();\r\n\r\n\r\n    this.date = this.myDate.substring(0, 10);\r\n    this.time = this.myDate.substring(11, 16);\r\n    this.event.startDate = this.myDate.substring(0, 10);\r\n\r\n\r\n    this.monthName = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];\r\n    this.shortMonthName = ['Ene.', 'Feb.', 'Mar.', 'Abr.', 'May.', 'Jun.', 'Jul.', 'Ago.', 'Sep.', 'Oct.', 'Nov.', 'Dic.'];\r\n    this.subjet = ['0', 'Cita', 'Llamada', 'Guardia', 'Vista de la Propiedad', 'Inspección', 'Domiciliaria', 'Otros', 'Seguimiento'];\r\n\r\n    this.platform.ready().then(() => {\r\n      this.calendar.listCalendars().then(data => {\r\n\r\n        this.calendars = data;\r\n\r\n        this.calendars.forEach((value, key, index) => {\r\n          if (value.isPrimary) {\r\n            this.calendarId = value.id;\r\n          }\r\n        });\r\n\r\n\r\n        //console.log(this.calendars);\r\n        //console.log(JSON.stringify(this.calendars));\r\n      }).catch(() => {\r\n\r\n      } )\r\n    })\r\n\r\n\r\n    this.leadForm = formBuilder.group({\r\n      subject: ['', [Validators.required]],\r\n      startDate: ['', [Validators.required]],\r\n      startTime: ['', [Validators.required]],\r\n      sinc: [''],\r\n      endDate: ['', [Validators.required]],\r\n      endTime: ['', [Validators.required]],\r\n      reDate: ['', [Validators.required]],\r\n      reTime: ['', [Validators.required]],\r\n      descripcion: ['', [Validators.required]]\r\n\r\n    });\r\n\r\n\r\n  }\r\n  valid(){\r\n\r\n  \r\n    if(this.leadForm.valid && this.nameClient != ''){\r\n      return false;\r\n    }else{\r\n\r\n      return true;\r\n\r\n    }\r\n  }\r\n    ionViewDidLoad() {\r\n    //console.log('ionViewDidLoad AddTaskPage');\r\n  } \r\n\r\n\r\n  save() {\r\n\r\n    //console.log(this.phoneCalendar);\r\n\r\n    var body = '';\r\n    var $this = this;\r\n    Object.keys(this.event).forEach(function (key) {\r\n      body += key + '=' + $this.event[key] + '&';\r\n    });\r\n    body += 'm=addTask&token=' + this.user.userToken;\r\n\r\n    //console.log(body);\r\n\r\n    var promise = this.user.addTask(body);\r\n\r\n    Promise.all([promise]).then(data => {\r\n\r\n\r\n      if(data[0]){\r\n\r\n        var opt: CalendarOptions = {\r\n          calendarId: this.calendarId,\r\n          firstReminderMinutes: 60,\r\n          id: this.calendarId + \"\"\r\n        };\r\n\r\n        var opts = { calendarId: this.calendarId, firstReminderMinutes: 120, id: this.calendarId + \"\" };\r\n\r\n        if (this.phoneCalendar) {\r\n          this.calendar.createEventInteractivelyWithOptions(this.subjet[this.event.subject], this.nameClient, this.event.descripcion, new Date(this.event.startDate), new Date(this.event.endDate), opts).then(\r\n            (msg) => {\r\n\r\n              let alert = this.alertCtrl.create({\r\n                title: 'Éxito',\r\n                subTitle: 'La tarea se agendo correctamente',\r\n                buttons: ['OK']\r\n              });\r\n              alert.present();\r\n              this.viewCtrl.dismiss({ data: 'reload' });\r\n\r\n            },\r\n            (err) => {\r\n              let alert = this.alertCtrl.create({\r\n                title: 'Éxito',\r\n                subTitle: 'La tarea se agendo correctamente en el sistema, pero tuvimos problemas al sincronizar con el calendario de tu teléfono.',\r\n                buttons: ['OK']\r\n              });\r\n              alert.present();\r\n              this.viewCtrl.dismiss({ data: 'reload' });\r\n            }\r\n          );\r\n        } else {\r\n\r\n          let alert = this.alertCtrl.create({\r\n            title: 'Éxito',\r\n            subTitle: 'La tarea se agendo correctamente',\r\n            buttons: ['OK']\r\n          });\r\n          alert.present();\r\n          this.viewCtrl.dismiss({data : 'reload'});\r\n        }\r\n\r\n\r\n\r\n\r\n      }else{\r\n        let alert = this.alertCtrl.create({\r\n          title: 'Error',\r\n          subTitle: 'Ocurrió un problema, intenta mas tarde.',\r\n          buttons: ['OK']\r\n        });\r\n\r\n        alert.present();\r\n        this.viewCtrl.dismiss({ data: 'reload' });\r\n      }\r\n   \r\n\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n  goCliente() {\r\n\r\n    this.navCtrl.push('LeadPickeadPage', 'lead').then(() => {\r\n\r\n      this.navCtrl.getActive().onDidDismiss(data => {\r\n        //console.log(data);\r\n        if (data) {\r\n          //console.log('si');\r\n          this.client = true;\r\n          this.nameClient = data.fullname;\r\n          this.event.folio = data.folio;\r\n        } else {\r\n          //console.log('no');\r\n          this.client = false;\r\n        }\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n  close() {\r\n\r\n    let alert = this.alertCtrl.create({\r\n      title: 'Atención',\r\n      message: 'Se perderá la información del formulario',\r\n      buttons: [\r\n        {\r\n          text: 'Cancelar',\r\n          role: 'cancel',\r\n        },\r\n        {\r\n          text: 'Salir',\r\n          handler: () => {\r\n\r\n            this.viewCtrl.dismiss({ data: 'reload' });\r\n          }\r\n        }\r\n      ]\r\n    });\r\n\r\n    alert.present();\r\n\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-task/add-task.ts"],"sourceRoot":""}